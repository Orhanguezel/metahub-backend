
---

# ğŸŒ **MetaHub Backend Ã‡oklu Dil (i18n) AltyapÄ± Raporu**

---

## 1. **Genel Mimari**

* **Tamamen field-bazlÄ±, Ã§ok dilli (multi-language) veri yÃ¶netimi** mevcut.
* Her modÃ¼lÃ¼n kendi Ã§eviri dosyasÄ± var ve backendâ€™in tamamÄ± i18n-ready.
* API seviyesinde her istek iÃ§in **dynamic locale** belirleniyor ve tÃ¼m cevaplar, loglar, validasyon mesajlarÄ± Ã§ok dilli Ã¼retilebiliyor.
* **Hardcoded/hardcoded dil stringâ€™i YOK!**

---

## 2. **Dil KodlarÄ± ve Desteklenen Diller**

* TÃ¼m sistemde `SUPPORTED_LOCALES` ile belirlenen diller dÄ±ÅŸÄ±nda ek dil kullanÄ±lmaz.
* `SupportedLocale` tipi ile tÃ¼m dil kodlarÄ± type-safe.

---

## 3. **Multi-Language Field YÃ¶netimi (Veri Modeli)**

* Her Ã§oklu dil alanÄ± (Ã¶rn: `name`, `description`, `label`)
  â†’ `{ tr: "...", en: "...", de: "...", ... }` ÅŸeklinde saklanÄ±r.
* `fillAllLocales()` ve benzeri yardÄ±mcÄ± fonksiyonlarla
  â†’ tek dilde girilen veri otomatik tÃ¼m dillere kopyalanÄ±r (minimum bir dil yeterli).
* `mergeLocalesForUpdate()` ile update iÅŸlemlerinde eksik kalan diller tamamlanÄ±r, var olanlar korunur.

---

## 4. **Dil AlgÄ±lama AkÄ±ÅŸÄ±**

* **`setLocale` middleware** ile istekten dil seÃ§imi sÄ±rasÄ±:

  1. `?locale=de` gibi query paramÄ±
  2. `body.locale`
  3. `Accept-Language` header
  4. `.env` (`LOG_LOCALE`)
  5. Default: `"en"`
* SonuÃ§ olarak **her requestâ€™e** `req.locale` atanÄ±r.

---

## 5. **Ã‡eviri ve String Getirme**

* **ModÃ¼l iÃ§i Ã§eviri dosyalarÄ±** (`translations`) ile `t(key, locale, translations, vars)` fonksiyonu:

  * Ä°lgili locale yoksa `"en"` fallback,
  * Vars parametreleriyle `{name}` gibi alanlar deÄŸiÅŸken olarak Ã§evrilebilir.
* Her yerde Ã§eviri fonksiyonuyla string Ã¼retilir, sabit string asla kullanÄ±lmaz.

---

## 6. **Multi-Language Veri DÃ¶nÃ¼ÅŸÃ¼mÃ¼ (parse, normalize, extract)**

* `fillAllLocales()`, `parseMultilangField()`, `normalizeMultilangField()` fonksiyonlarÄ± ile

  * Tek dilde veya kÄ±smi obje ile gelen data her zaman TÃœM localeâ€™lere normalize edilir.
* `extractMultilangValue(field, locale)` ile sadece istenen dilde string dÃ¶ndÃ¼rÃ¼lÃ¼r.
* `fillFields(obj, fields)` ile birden fazla Ã§oklu dil alanÄ± olan objeler normalize edilir.

---

## 7. **Validasyon ve DoÄŸrulama**

* `validateMultilangField("field")` express-validator ile:

  * Field bir obje olmalÄ±,
  * En az bir locale boÅŸ olmamalÄ±.
* HatalÄ±/gÃ¶nderilmeyen fieldâ€™lar iÃ§in Ã§ok dilli validasyon mesajlarÄ± gÃ¶sterilir.

---

## 8. **Log ve Analyticsâ€™te Dil Bilgisi**

* Log ve analytics kayÄ±tlarÄ±nda

  * Hangi locale ile iÅŸlem yapÄ±ldÄ±ÄŸÄ±,
  * Log mesajlarÄ±nÄ±n localeâ€™a uygun Ã¼retilmesi (i18n ile),
  * GeliÅŸmiÅŸ log context (tenant, user, module, event, status, locale) ile tam izlenebilirlik.

---

## 9. **GeliÅŸmiÅŸ KullanÄ±m ve Yedek Fonksiyonlar**

* `getLogLocale()` â€” Loggerâ€™Ä±n default dilini otomatik belirler (`process.env.LOG_LOCALE`).
* Merge ve update fonksiyonlarÄ± ile her gÃ¼ncellemede dil eksikliÄŸi oluÅŸmaz.
* Locale zorunluluÄŸu olmayan alanlarda bile sistem fallback ile doÄŸru localeâ€™a dÃ¶ner.

---

## 10. **Best-Practice ve GÃ¼Ã§lÃ¼ Yanlar**

* **Tamamen centralized**: TÃ¼m dil iÅŸlemleri ve validasyon tek noktadan yÃ¶netiliyor.
* **Backend-level i18n**: Hem log, hem veri, hem validasyon tamamen Ã§oklu dil.
* **Extensible**: Yeni bir locale eklemek, sadece SUPPORTED\_LOCALESâ€™a ekleme yapÄ±p translationlarÄ± tanÄ±mlamak kadar kolay.
* **Frontend baÄŸÄ±msÄ±z**: API her zaman backendâ€™de Ã§ok dilli ve frontendâ€™e gÃ¶re adapte olabiliyor.

---

## 11. **Eksik/KÃ¼Ã§Ã¼k Ä°yileÅŸtirme NotlarÄ±**

* BazÄ± fonksiyonlarda aynÄ± `fillAllLocales` kodunun kopyasÄ± var. Tek dosyada DRY (Don't Repeat Yourself) yapÄ±labilir.
* Validasyon error mesajlarÄ± da i18n olarak Ã¼retilebilir. (Zaten Ã§oÄŸu yerde var, global error handlerâ€™a taÅŸÄ±nabilir.)
* Ã‡ok bÃ¼yÃ¼k translation dosyalarÄ±nda cache kullanmak performansÄ± artÄ±rabilir (ÅŸu anda ihtiyaÃ§ yok gibi gÃ¶rÃ¼nÃ¼yor).
* Yeni bir dil ekleneceÄŸi zaman, tÃ¼m modÃ¼l i18n dosyalarÄ±nÄ± kolayca bulk gÃ¼ncelleyebilecek script/prosedÃ¼r eklenebilir.

---

## 12. **Checklist / ModÃ¼l StandartlarÄ±**

Her modÃ¼l ÅŸu kurallara uymalÄ±:

| Kural                                              | AÃ§Ä±klama                                    |
| -------------------------------------------------- | ------------------------------------------- |
| Alanlar TranslatedLabel tipi mi?                   | name/label gibi alanlar `{tr, en, de, ...}` |
| Veri her zaman fillAllLocales ile normalize        | Tek dil bile gelse, tÃ¼m localeâ€™ler dolmalÄ±  |
| DÃ¶nÃ¼ÅŸte parseMultilangField kullanÄ±lÄ±yor mu?       | API output her zaman standart yapÄ±da mÄ±?    |
| Log ve validasyon mesajlarÄ± translate() ile mi?    | Hardcoded string asla yok                   |
| Validasyon en az bir dil zorunlu mu?               | Multi-lang field iÃ§in                       |
| SUPPORTED\_LOCALES gÃ¼ncel ve modÃ¼llerle uyumlu mu? | TÃ¼m sistemde tek tip                        |

---

## 13. **GeleceÄŸe YÃ¶nelik Ã–neriler**

* **Ã‡ok dilli fieldâ€™lar iÃ§in otomatik testler** eklenebilir (bir dilde veri eksikse otomatik hata).
* **Translation dosyalarÄ± bulk update, check scripti** (eksik key kontrolÃ¼, unused key temizliÄŸi).
* Validasyon ve hata mesajlarÄ±nÄ± da global i18n error dosyalarÄ±ndan Ã§ekmek iÃ§in merkezi error handler.
* â€œTÃ¼m tenantlar aynÄ± dili mi kullanacak, tenantâ€™a Ã¶zel dil aktif/pasif mi olacak?â€ sorusu ileride customization iÃ§in aÃ§Ä±labilir.

---

# **SONUÃ‡**

* **MetaHub backendâ€™in dil sistemi, modern SaaS standartlarÄ±na %100 uygun, scalable ve future-proof.**
* Her modÃ¼l, response, log ve validationâ€™da Ã§oklu dil desteÄŸi, sabit stringsiz, izole ve tipli bir yapÄ±da.
* Sistem yeni diller ve modÃ¼ller eklendiÄŸinde minimum effort ile bÃ¼yÃ¼tÃ¼lebilir ve sÃ¼rdÃ¼rÃ¼lebilir.

---
